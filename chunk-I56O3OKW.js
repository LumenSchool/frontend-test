import{a as m}from"./chunk-52QCCMRP.js";import{c as d,d as g,e as b}from"./chunk-LNP3BX6U.js";import{M as l,Q as h,l as u,p as o,w as i}from"./chunk-5NGP2AU4.js";var f=class p{constructor(t){this.http=t}baseUrl=m.apiUrl;token=null;id=null;register(t,e,r){let s=`${this.baseUrl}/auth/register`,n={email:t,password:r,name:e,is_active:!0,is_superuser:!1,is_verified:!1,github_login:"",role:"user",hashed_password:""},a={Accept:"application/json","Content-Type":"application/json"};return this.http.post(s,n,{headers:a}).pipe(o(c=>(this.token=c.id,{data:c,success:!0})),i(this.handleError))}login(t,e){let r=`${this.baseUrl}/auth/jwt/login`,s=new URLSearchParams({username:t,password:e});return this.http.post(r,s).pipe(o(n=>(this.token=n.access_token,{data:n,success:!0})),i(this.handleError))}loginPassword(t,e){let r=`${this.baseUrl}/auth/jwt/login`,s=new URLSearchParams({grant_type:"password",username:t,password:e}),n={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"};return this.http.post(r,s,{headers:n}).pipe(o(a=>(this.token=a.access_token,{data:a,success:!0})),i(this.handleError))}logout(){let t=`${this.baseUrl}/auth/jwt/logout`,e=this.getAuthHeaders();return this.http.post(t,{headers:e}).pipe(o(r=>(this.token=null,{data:r,success:!0})),i(this.handleError))}getProducts(){let t=`${this.baseUrl}/v1/products/`,e=50,r=0,s=new g;s=s.set("limit",e),s=s.set("offset",r);let n={Accept:"application/json","Content-Type":"application/json"};return this.http.get(t,{headers:n,params:s}).pipe(o(a=>({data:a,success:!0})),i(this.handleError))}isAuthenticated(){return!!this.token}get(t){let e=`${this.baseUrl}/${t}`,r=this.getAuthHeaders();return this.http.get(e,{headers:r}).pipe(o(s=>({data:s,success:!0})),i(this.handleError))}post(t,e){let r=`${this.baseUrl}/${t}`,s=this.getAuthHeaders();return this.http.post(r,e,{headers:s}).pipe(o(n=>({data:n,success:!0})),i(this.handleError))}put(t,e){let r=`${this.baseUrl}/${t}`,s=this.getAuthHeaders();return this.http.put(r,e,{headers:s}).pipe(o(n=>({data:n,success:!0})),i(this.handleError))}delete(t){let e=`${this.baseUrl}/${t}`,r=this.getAuthHeaders();return this.http.delete(e,{headers:r}).pipe(o(s=>({data:s,success:!0})),i(this.handleError))}getAuthHeaders(){let t=new d;return this.token&&(t=t.set("Authorization",`Bearer ${this.token}`),t=t.set("Accept","application/json"),t=t.set("Content-Type","application/json")),t}handleError(t){let e=t.message||"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430";return console.error("HTTP Error:",t),u({data:null,success:!1,message:e})}static \u0275fac=function(e){return new(e||p)(h(b))};static \u0275prov=l({token:p,factory:p.\u0275fac,providedIn:"root"})};export{f as a};
